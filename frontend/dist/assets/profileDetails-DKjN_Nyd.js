import{c as u,a8 as q,r as i,j as e,a9 as S,H,U as K,L as _,aa as W,a as Y,ab as Z}from"./index-B1o_CHU3.js";import{v as J}from"./reports-D37mP4Ld.js";import{A as Q}from"./arrow-left-BSp29dui.js";import{S as X}from"./shield-check-CKoivh36.js";import{C as E}from"./circle-check-D_6jh5lz.js";import{C as R}from"./circle-alert-Cy5nYx3R.js";const ee=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],se=u("book-open",ee);const ae=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],te=u("camera",ae);const re=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],le=u("cloud-upload",re);const ie=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],F=u("file-check",ie);const ne=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],ce=u("refresh-ccw",ne);const oe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],de=u("zap",oe),me="https://glacial-samiyah-presutural.ngrok-free.dev",xe=["image/jpeg","image/png","image/jpg"],je=()=>{const m=q(),[s,l]=i.useState({idNumber:"",firstName:"",middleInitial:"",lastName:"",course:"",address:"",guardianName:"",guardianContact:"",id_picture:null,signature_picture:null}),[p,d]=i.useState(!1),[c,x]=i.useState("idle"),[U,T]=i.useState(""),[j,I]=i.useState(!1),[N,v]=i.useState({id:0,sig:0}),[b,A]=i.useState(!1),[f,z]=i.useState(!1),[h,P]=i.useState(""),y=!s.idNumber||!s.firstName||!s.lastName||!s.id_picture||!s.signature_picture,O=a=>{v(t=>({...t,[a]:0}));const r=setInterval(()=>{v(t=>{const n=t[a];return n>=92?(clearInterval(r),t):{...t,[a]:n+(n<60?12:3)}})},250);return r},B=async(a,r)=>{const t=r==="id_picture"?"id":"sig";r==="id_picture"?A(!0):z(!0);const n=O(t);try{const w=await new Promise(g=>{const C=new FileReader;C.onload=()=>g(C.result),C.readAsDataURL(a)}),k=await Z.post(`${me}/process_and_return`,{photo:w,type:r},{responseType:"blob",timeout:6e4}),G=new File([k.data],`processed_${t}.webp`,{type:"image/webp"});l(g=>({...g,[r]:G})),v(g=>({...g,[t]:100}))}catch(w){console.error("Bridge Error:",w),l(k=>({...k,[r]:a}))}finally{clearInterval(n),setTimeout(()=>{A(!1),z(!1)},400)}},M=async(a,r)=>{const t=a.target.files?.[0];t&&xe.includes(t.type)&&await B(t,r)},L=i.useMemo(()=>s.id_picture?URL.createObjectURL(s.id_picture):"",[s.id_picture]),D=i.useMemo(()=>s.signature_picture?URL.createObjectURL(s.signature_picture):"",[s.signature_picture]),V=async a=>{if(a.preventDefault(),!y){I(!0);try{await W();const r=new FormData;Object.entries(s).forEach(([t,n])=>{n!==null&&r.append(t,n)}),await Y.post("/students",r,{headers:{"Content-Type":"multipart/form-data"}}),P("success"),window.scrollTo({top:0,behavior:"smooth"})}catch{P("error")}finally{I(!1)}}};return i.useEffect(()=>{if(s.idNumber.length>=8){const a=setTimeout(async()=>{d(!0);try{const r=await J(s.idNumber);if(r.valid){x("valid");const t=r.data;l(n=>({...n,firstName:t.firstName||"",middleInitial:t.middleName?t.middleName.charAt(0).toUpperCase():"",lastName:t.lastName||"",course:t.course||n.course}))}}catch{x("invalid"),T("ID Not Found")}finally{d(!1)}},800);return()=>clearTimeout(a)}},[s.idNumber]),e.jsxs("div",{className:"min-h-screen bg-[#f1f5f9] font-sans pb-20",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-2xl border-b border-slate-200 px-4 md:px-10 py-4",children:e.jsxs("div",{className:"max-w-[1440px] mx-auto flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>m("/"),className:"flex items-center gap-3 text-slate-600 font-bold group",children:[e.jsx("div",{className:"p-2.5 bg-slate-100 group-hover:bg-teal-50 rounded-2xl transition-colors",children:e.jsx(Q,{size:22})}),e.jsx("span",{className:"hidden md:inline-block",children:"Exit"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-[10px] font-black tracking-[0.3em] text-teal-600 uppercase",children:"NCnian School ID"}),e.jsx("p",{className:"text-sm lg:text-xl font-black text-slate-900 uppercase",children:"Application Form"})]}),e.jsxs("div",{className:"hidden lg:flex items-center gap-2 text-slate-400 bg-slate-50 px-4 py-2 rounded-2xl border border-slate-100",children:[e.jsx(X,{size:16}),e.jsx("span",{className:"text-[10px] font-black uppercase",children:"Secure Session"})]})]})}),e.jsxs(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-7xl mx-auto mt-8 px-4",children:[e.jsx(H,{children:(h==="success"||c==="invalid")&&e.jsxs(S.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`mb-6 p-6 rounded-[2rem] border shadow-sm flex items-center justify-between ${h==="success"?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-rose-50 border-rose-200 text-rose-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h==="success"?e.jsx(E,{size:20}):e.jsx(R,{size:20}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:h==="success"?"Application Submitted!":U})]}),h==="success"&&e.jsx("button",{onClick:()=>m("/"),className:"bg-emerald-600 text-white px-6 py-2 rounded-xl text-xs font-bold",children:"Done"})]})}),e.jsxs("form",{onSubmit:V,className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[e.jsxs($,{icon:e.jsx(se,{}),title:"Academic Standing",subtitle:"Primary Data",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(o,{label:"ID Number",value:s.idNumber,onChange:a=>l({...s,idNumber:a}),status:c,isLoading:p}),e.jsx(o,{label:"Course",value:s.course,onChange:a=>l({...s,course:a})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mt-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(o,{label:"Given Name",value:s.firstName,onChange:a=>l({...s,firstName:a})})}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(o,{label:"M.I.",value:s.middleInitial,onChange:a=>l({...s,middleInitial:a})})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(o,{label:"Surname",value:s.lastName,onChange:a=>l({...s,lastName:a})})})]})]}),e.jsxs($,{icon:e.jsx(K,{}),title:"Personal Data",subtitle:"Guardian & Address",children:[e.jsx(o,{label:"Address",value:s.address,onChange:a=>l({...s,address:a}),isTextArea:!0}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsx(o,{label:"Guardian Name",value:s.guardianName,onChange:a=>l({...s,guardianName:a})}),e.jsx(o,{label:"Guardian Contact",value:s.guardianContact,onChange:a=>l({...s,guardianContact:a})})]})]})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-[3rem] shadow-xl border border-slate-100 space-y-10",children:[e.jsx("h3",{className:"text-xs font-black text-slate-400 uppercase tracking-widest text-center",children:"Biometric Previews"}),e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsxs("div",{className:"relative mx-auto w-40 h-40",children:[e.jsx("div",{className:`w-full h-full rounded-[2.5rem] bg-slate-50 border-2 border-dashed flex flex-col items-center justify-center overflow-hidden transition-all duration-300 ${b?"border-teal-500 bg-teal-50 shadow-inner":"border-slate-200"}`,children:b?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(ce,{className:"animate-spin text-teal-600",size:40}),e.jsxs("span",{className:"absolute text-[10px] font-black text-teal-800",children:[N.id,"%"]})]}),e.jsx("span",{className:"text-[9px] font-black text-teal-700 uppercase",children:"Enhancing..."})]}):L?e.jsx("img",{src:L,className:"w-full h-full object-cover"}):e.jsx(le,{size:40,className:"text-slate-300"})}),e.jsx("input",{type:"file",id:"id-p",hidden:!0,onChange:a=>M(a,"id_picture"),disabled:b}),e.jsx("label",{htmlFor:"id-p",className:"absolute -bottom-2 -right-2 bg-teal-600 text-white p-3 rounded-2xl cursor-pointer shadow-lg hover:scale-110 transition-transform",children:e.jsx(te,{size:20})})]}),e.jsx("div",{className:"px-10",children:e.jsx("div",{className:"h-1 bg-slate-100 rounded-full overflow-hidden",children:e.jsx(S.div,{initial:{width:0},animate:{width:`${N.id}%`},className:"h-full bg-teal-500"})})}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Student Photo (2x2)"})]}),e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsxs("div",{className:"relative mx-auto w-full h-24",children:[e.jsx("div",{className:`w-full h-full rounded-3xl bg-slate-50 border-2 border-dashed flex flex-col items-center justify-center overflow-hidden transition-all ${f?"border-teal-500 bg-teal-50":"border-slate-200"}`,children:f?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"animate-spin text-teal-600"}),e.jsxs("span",{className:"text-xs font-black text-teal-800",children:[N.sig,"%"]})]}):D?e.jsx("img",{src:D,className:"w-full h-full object-contain p-2"}):e.jsx(F,{size:32,className:"text-slate-300"})}),e.jsx("input",{type:"file",id:"sig-p",hidden:!0,onChange:a=>M(a,"signature_picture"),disabled:f}),e.jsx("label",{htmlFor:"sig-p",className:"absolute -bottom-2 -right-2 bg-slate-800 text-white p-3 rounded-2xl cursor-pointer shadow-lg hover:scale-110 transition-transform",children:e.jsx(F,{size:20})})]}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Digital Signature"})]}),e.jsxs("button",{type:"submit",disabled:j||b||f||c!=="valid"||y,className:`w-full py-6 rounded-[2rem] font-black text-sm tracking-[0.2em] shadow-xl transition-all flex items-center justify-center gap-2 ${c==="valid"&&!y?"bg-[#00928a] text-white hover:bg-[#007a73] active:scale-95":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[j?e.jsx(_,{className:"animate-spin"}):e.jsx(de,{size:18}),j?"PROCESSING...":"SUBMIT APPLICATION"]})]})})]})]})]})},$=({icon:m,title:s,subtitle:l,children:p})=>e.jsxs("div",{className:"bg-white p-10 rounded-[3.5rem] shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"w-12 h-12 bg-teal-50 rounded-2xl flex items-center justify-center text-teal-600",children:m}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 tracking-tight",children:s}),e.jsx("p",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest",children:l})]})]}),p]}),o=({label:m,value:s,onChange:l,isTextArea:p=!1,status:d="idle",isLoading:c=!1})=>e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-[10px] font-black text-slate-400 uppercase mb-2 ml-2 tracking-widest",children:m}),e.jsx("div",{className:"relative",children:p?e.jsx("textarea",{value:s,onChange:x=>l(x.target.value),rows:3,className:"w-full bg-slate-50 border border-slate-200 rounded-3xl p-5 outline-none focus:bg-white focus:border-teal-500 transition-all"}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:s,onChange:x=>l(x.target.value),className:`w-full bg-slate-50 border rounded-3xl p-5 outline-none transition-all ${d==="valid"?"border-emerald-500":d==="invalid"?"border-rose-500":"border-slate-200 focus:border-teal-500"}`}),e.jsxs("div",{className:"absolute right-5 top-1/2 -translate-y-1/2",children:[c&&e.jsx(_,{className:"animate-spin text-teal-500",size:18}),d==="valid"&&!c&&e.jsx(E,{className:"text-emerald-500",size:18}),d==="invalid"&&!c&&e.jsx(R,{className:"text-rose-500",size:18})]})]})})]});export{je as default};
