const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PrintPreviewModal-BQNw7YjA.js","assets/index-HxQ3xhrO.js","assets/index-D1u3qIBU.css","assets/students-rxOQqjFe.js","assets/download-B7xri9tM.js","assets/map-pin-Dl9GpKlo.js","assets/index-BUY36PCx.js","assets/designerUtils--5GeOf_A.js","assets/refresh-cw-2P735yn4.js","assets/circle-check-Cx2cfC9n.js"])))=>i.map(i=>d[i]);
import{c as P,r as n,u as A,j as e,P as Z,g as ee,A as se,f as ae,S as te,E as re,h as le,B as de,F as ne,G as F,I as q,R as U,C as ce,T as ie,H as oe,J as xe,U as me,K as he,x as pe,N as X,n as be,_ as ue,a as ge}from"./index-HxQ3xhrO.js";import{u as V,M as fe}from"./map-pin-Dl9GpKlo.js";import{g as je}from"./students-rxOQqjFe.js";import{e as Ne}from"./index-BUY36PCx.js";import{r as ve,S as K,T as ye}from"./designerUtils--5GeOf_A.js";import{R as M}from"./refresh-cw-2P735yn4.js";import{C as ke}from"./circle-check-Cx2cfC9n.js";const we=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ze=P("ban",we);const _e=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Se=P("phone",_e);const Ie=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Ce=P("printer",Ie),G="https://dashboard-ncnian-id.svizcarra.online",Re=n.memo(({src:l,common:x})=>{const[i]=A(l,"anonymous");return i?e.jsx(q,{...x,image:i}):null}),Te=({data:l,layout:x,side:i,scale:b=1,isPrinting:c=!1})=>{const v=d=>{if(!d)return"";if(d.startsWith("data:")||d.startsWith("blob:"))return d;const r=`${G}/storage/`;let t=d;return d.startsWith(r)&&(t=d.replace(r,"")),`${G}/api/proxy-image?path=${encodeURIComponent(t)}`},[m]=A(v(l.photo),"anonymous"),[I]=A(v(l.signature),"anonymous"),y=x?.[i.toLowerCase()];if(!y)return null;const C=c?se:ae,k=c?Z:ee,_=c?C:C*b,h=c?k:k*b,w=c?de:1,S=c?ne:1,u=(d,r)=>{const t=d==="photo",g=t||d==="signature",f=d.startsWith("img_"),T=d.startsWith("rect")||d.startsWith("circle"),E=r.x*w,L=r.y*S,s=(r.width||200)*w,a=(r.height||180)*S,o=(r.radius||0)*Math.min(w,S),R=r.fit==="none"?void 0:a,p={key:d,x:E,y:L,width:s,rotation:r.rotation||0,opacity:r.opacity??1};if(g){const j=t?m:I;return n.createElement(F,{...p,height:a,key:d},e.jsx(F,{clipFunc:N=>{N.beginPath(),o>0&&N.roundRect?N.roundRect(0,0,s,a,o):N.rect(0,0,s,a),N.closePath()},children:j?e.jsx(q,{image:j,width:s,height:a,sceneFunc:(N,De)=>{const $=Math.min(s/j.width,a/j.height),H=j.width*$,W=j.height*$,Q=(s-H)/2,J=(a-W)/2;N.drawImage(j,Q,J,H,W)}}):e.jsx(U,{width:s,height:a,fill:"#f1f5f9"})}))}if(f&&r.src)return e.jsx(Re,{src:r.src,common:{...p,height:a}},d);if(T)return r.type==="circle"?n.createElement(ce,{...p,height:a,radius:s/2,fill:r.fill||"#00ffe1ff",key:d}):n.createElement(U,{...p,height:a,fill:r.fill||"#00ffe1ff",cornerRadius:o,key:d});const B={fullName:l.fullName,idNumber:l.idNumber,course:r.text||l.course,guardian_name:l.guardian_name,guardian_contact:l.guardian_contact,address:l.address}[d]||l[d]||r.text||"",Y=c?{...r,width:s,height:a,fontSize:r.fontSize*w}:r,D=ve(Y,B);return n.createElement(ie,{...p,key:d,height:R,text:B,fontSize:D.fontSize,fontFamily:r.fontFamily||"Arial",fontStyle:r.fontStyle||"bold",fill:r.fill||"#1e293b",align:r.align||"center",verticalAlign:"middle",wrap:D.wrap,ellipsis:r.overflow==="ellipsis"})};return e.jsx("div",{style:{width:`${_}px`,height:`${h}px`,position:"relative",backgroundColor:"white",borderRadius:c?"0":"12px",overflow:"hidden",boxShadow:c?"none":"0 10px 15px -3px rgb(0 0 0 / 0.1)"},children:e.jsx(te,{width:_,height:h,scaleX:c?1:b,scaleY:c?1:b,pixelRatio:c?re:1,children:e.jsx(le,{children:Object.entries(y).map(([d,r])=>u(d,r))})})})},O=n.memo(Te),Ee=()=>e.jsx("div",{className:"h-full bg-slate-600 dark:bg-[#020617] flex flex-col overflow-hidden animate-pulse",children:e.jsxs("main",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("aside",{className:"w-[660px] bg-white dark:bg-zinc-950 flex flex-col border-r border-slate-200 dark:border-zinc-900 shadow-2xl shrink-0",children:[e.jsx("div",{className:"p-4 bg-slate-50/50 dark:bg-zinc-900/30 border-b border-slate-200 dark:border-zinc-900",children:e.jsxs("div",{className:"flex flex-row gap-4 items-center justify-center",children:[e.jsx("div",{className:"w-[180px] h-[110px] bg-slate-200 dark:bg-zinc-800 rounded-lg shadow-sm"}),e.jsx("div",{className:"w-[180px] h-[110px] bg-slate-200 dark:bg-zinc-800 rounded-lg shadow-sm"})]})}),e.jsxs("div",{className:"flex-1 px-6 py-8 space-y-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-8 w-3/4 bg-slate-200 dark:bg-zinc-800 rounded-md"}),e.jsx("div",{className:"h-6 w-1/2 bg-slate-100 dark:bg-zinc-900 rounded-md"})]}),e.jsxs("div",{className:"space-y-6 border border-slate-100 dark:border-zinc-900 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-px flex-1 bg-slate-100 dark:bg-zinc-800"}),e.jsx("div",{className:"h-2 w-24 bg-slate-100 dark:bg-zinc-900 rounded"}),e.jsx("div",{className:"h-px flex-1 bg-slate-100 dark:bg-zinc-800"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-zinc-900/50 h-16"}),e.jsx("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-zinc-900/50 h-16"})]}),e.jsx("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-zinc-900/50 h-20"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-zinc-900 grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"h-12 bg-slate-100 dark:bg-zinc-900 rounded-xl"}),e.jsx("div",{className:"h-12 bg-teal-200 dark:bg-teal-900/30 rounded-xl"})]})]}),e.jsxs("section",{className:"flex-1 flex flex-col overflow-hidden bg-white dark:bg-[#020617]",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-zinc-900 flex items-center justify-between gap-4",children:[e.jsx("div",{className:"h-10 w-full max-w-md bg-slate-100 dark:bg-zinc-900 rounded-lg"}),e.jsx("div",{className:"h-10 w-10 bg-slate-100 dark:bg-zinc-900 rounded-lg"})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex px-6 py-4 bg-slate-50 dark:bg-zinc-950 border-b border-slate-100 dark:border-zinc-900",children:[e.jsx("div",{className:"w-12 h-4 bg-slate-200 dark:bg-zinc-800 rounded mr-4"}),e.jsx("div",{className:"flex-1 h-4 bg-slate-200 dark:bg-zinc-800 rounded mr-4"}),e.jsx("div",{className:"w-32 h-4 bg-slate-200 dark:bg-zinc-800 rounded mr-4"}),e.jsx("div",{className:"w-24 h-4 bg-slate-200 dark:bg-zinc-800 rounded mr-4"}),e.jsx("div",{className:"w-24 h-4 bg-slate-200 dark:bg-zinc-800 rounded"})]}),[...Array(8)].map((l,x)=>e.jsxs("div",{className:"flex px-6 py-8 border-b border-slate-50 dark:border-zinc-900 items-center",children:[e.jsx("div",{className:"w-5 h-5 bg-slate-100 dark:bg-zinc-900 rounded mr-8"}),e.jsxs("div",{className:"flex-1 space-y-2 mr-4",children:[e.jsx("div",{className:"h-3 w-48 bg-slate-200 dark:bg-zinc-800 rounded"}),e.jsx("div",{className:"h-2 w-32 bg-slate-100 dark:bg-zinc-900 rounded"})]}),e.jsx("div",{className:"w-32 h-3 bg-slate-100 dark:bg-zinc-900 rounded mr-4"}),e.jsx("div",{className:"w-24 h-5 bg-slate-100 dark:bg-zinc-900 rounded-full mr-4"}),e.jsx("div",{className:"w-24 h-3 bg-slate-100 dark:bg-zinc-900 rounded"})]},x))]})})]})]})}),Le=n.lazy(()=>ue(()=>import("./PrintPreviewModal-BQNw7YjA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),Ae="https://dashboard-ncnian-id.svizcarra.online",Me=be.memo(({student:l,isActive:x,isSelected:i,onSelect:b,onView:c,courses:v})=>e.jsxs("tr",{onClick:()=>c(l.id),className:`group hover:bg-slate-50 dark:hover:bg-zinc-900/40 transition-colors cursor-pointer ${x?"bg-teal-500/10 dark:bg-teal-500/10":""}`,children:[e.jsx("td",{className:"pl-6 py-4",onClick:m=>{m.stopPropagation(),b(l.id)},children:i?e.jsx(X,{size:16,className:"text-teal-500"}):e.jsx(K,{size:16,className:"opacity-20 group-hover:opacity-40"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-[11px] font-black uppercase",children:[l.last_name,", ",l.first_name]})}),e.jsx("td",{className:"px-4 py-3 font-mono text-[10px] font-bold text-slate-400",children:l.id_number}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-[9px] font-black uppercase px-2 py-0.5 rounded border ${v[l.course]?.border||"border-slate-200"} ${v[l.course]?.color||"text-slate-400"}`,children:l.course})}),e.jsx("td",{className:"px-4 py-3",children:l.has_card?e.jsxs("div",{className:"text-emerald-500 flex items-center gap-1 text-[9px] font-black uppercase",children:[e.jsx(ke,{size:10})," Printed"]}):e.jsxs("div",{className:"text-amber-500 flex items-center gap-1 text-[9px] font-black uppercase",children:[e.jsx(M,{size:10,className:"animate-spin-slow"})," In Queue"]})}),e.jsx("td",{className:"px-4 py-3 text-right pr-6",children:e.jsx("button",{onClick:m=>{m.stopPropagation()},className:"p-1.5 text-slate-300 hover:text-red-500 transition-opacity opacity-0 group-hover:opacity-100",children:e.jsx(ye,{size:14})})})]})),Pe=()=>{const[l,x]=n.useState(""),[i,b]=n.useState("created_at"),[c,v]=n.useState("desc"),[m,I]=n.useState([]),[y,C]=n.useState(null),[k,_]=n.useState(null),{data:h=[],isLoading:w,refetch:S}=V({queryKey:["students"],queryFn:async()=>{const s=await je();return[...s.queueList||[],...s.history||[]]},staleTime:6e4}),{data:u=[],isLoading:d}=V({queryKey:["layouts"],queryFn:async()=>(await ge.get("/card-layouts")).data}),r=n.useMemo(()=>({BSGE:{name:"BSGE",color:"text-red-600",border:"border-red-200",bg:"bg-red-50"},BSN:{name:"BSN",color:"text-pink-500",border:"border-pink-200",bg:"bg-pink-50"},BSIT:{name:"BSIT",color:"text-cyan-600",border:"border-cyan-200",bg:"bg-cyan-50"},BSBA:{name:"BSBA",color:"text-amber-600",border:"border-amber-200",bg:"bg-amber-50"},BSCRIM:{name:"BSCRIM",color:"text-slate-700",border:"border-slate-200",bg:"bg-slate-100"}}),[]),t=n.useMemo(()=>y?h.find(s=>s.id===y)||null:h.find(s=>!s.has_card)||h[0]||null,[h,y]),z=n.useMemo(()=>{if(!t||u.length===0)return null;const a=u.find(o=>o.name.trim().toUpperCase()===t.course.trim().toUpperCase())||u.find(o=>o.is_active)||u[0];return{front:a.front_config,back:a.back_config,previewImages:a.previewImages||{front:"",back:""}}},[t,u]),g=n.useMemo(()=>{if(!t)return null;const s=a=>a?a.startsWith("http")?a:`${Ae}/storage/${a}`:"";return{id:t.id,fullName:`${t.first_name} ${t.last_name}`,idNumber:t.id_number,course:t.course,photo:s(t.id_picture),signature:s(t.signature_picture),guardian_name:t.guardian_name,guardian_contact:t.guardian_contact,address:t.address}},[t]),f=n.useMemo(()=>{const s=l.toLowerCase().trim();return h.filter(a=>s?a.id_number.toLowerCase().includes(s)||`${a.first_name} ${a.last_name}`.toLowerCase().includes(s)||a.course.toLowerCase().includes(s):!0).sort((a,o)=>{let R=i==="created_at"?new Date(a.created_at).getTime():a[i],p=i==="created_at"?new Date(o.created_at).getTime():o[i];return c==="asc"?R>p?1:-1:R<p?1:-1})},[h,l,i,c]),T=n.useCallback(s=>{I(a=>a.includes(s)?a.filter(o=>o!==s):[...a,s])},[]),E=n.useCallback(s=>{C(s)},[]),L=async s=>{z&&g&&_({student:g,layout:z})};return w||d?e.jsx(Ee,{}):e.jsxs("div",{className:"h-full bg-slate-50 dark:bg-[#020617] text-slate-900 dark:text-slate-100 flex flex-col overflow-hidden",children:[e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsx(M,{className:"animate-spin text-white",size:48})}),children:e.jsx(oe,{children:k&&e.jsx(Le,{data:k.student,layout:k.layout,onClose:()=>_(null)})})}),e.jsxs("main",{className:"flex-1 flex overflow-hidden",children:[e.jsx("aside",{className:"bg-white dark:bg-zinc-950 flex flex-col border-r border-slate-200 dark:border-zinc-900 shadow-2xl shrink-0",children:t&&g&&z?e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsx("div",{className:"p-5 bg-slate-50/50 dark:bg-zinc-900/30 border-b border-slate-200 dark:border-zinc-900",children:e.jsxs("div",{className:"flex flex-row gap-4 items-center justify-center",children:[e.jsx(O,{data:g,layout:z,side:"FRONT",scale:.9}),e.jsx(O,{data:g,layout:z,side:"BACK",scale:.9})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-slate-900 dark:text-white tracking-tighter uppercase flex items-center gap-2",children:[e.jsx(Ne,{className:"text-teal-500"})," ",t.last_name,", ",t.first_name]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("span",{className:"flex items-center gap-2 text-lg font-bold text-slate-500",children:[e.jsx(xe,{size:20})," ",t.id_number]}),e.jsx("span",{className:"px-2 py-1 rounded bg-zinc-100 dark:bg-zinc-800 text-[10px] font-black uppercase",children:t.course})]})]}),e.jsxs("div",{className:"space-y-4 border border-zinc-100 dark:border-zinc-900 rounded-2xl p-4 bg-slate-50/30 dark:bg-zinc-900/20",children:[e.jsx("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-[0.2em]",children:"Detailed Record Info"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-[10px] text-slate-400 uppercase font-bold flex items-center gap-1",children:[e.jsx(me,{size:10})," Guardian"]}),e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-zinc-200",children:t.guardian_name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-[10px] text-slate-400 uppercase font-bold flex items-center gap-1",children:[e.jsx(Se,{size:10})," Contact"]}),e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-zinc-200",children:t.guardian_contact})]})]}),e.jsxs("div",{className:"pt-2 border-t border-zinc-100 dark:border-zinc-900",children:[e.jsxs("span",{className:"text-[10px] text-slate-400 uppercase font-bold flex items-center gap-1",children:[e.jsx(fe,{size:10})," Residential Address"]}),e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-zinc-200",children:t.address})]})]})]}),e.jsxs("div",{className:"p-6 bg-white dark:bg-zinc-950 border-t border-slate-100 dark:border-zinc-900 grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"flex items-center justify-center gap-2 py-3.5 rounded-xl border border-red-500/30 text-red-500 hover:bg-red-500 hover:text-white font-black text-[11px] uppercase transition-all",children:[e.jsx(ze,{size:14})," Reject Entry"]}),e.jsxs("button",{onClick:()=>L(t.id),className:"flex items-center justify-center gap-2 py-3.5 rounded-xl bg-teal-500 hover:bg-teal-600 text-white font-black text-[11px] uppercase transition-all shadow-lg shadow-teal-500/20",children:[e.jsx(Ce,{size:14})," Confirm & Print"]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center",children:[e.jsx(he,{size:40,className:"text-slate-200 dark:text-zinc-800 mb-4"}),e.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-slate-400",children:"Queue Empty"})]})}),e.jsxs("section",{className:"flex-1 flex flex-col overflow-hidden bg-white dark:bg-[#020617]",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-zinc-900 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),e.jsx("input",{type:"text",placeholder:"Filter directory by name, ID or course...",value:l,onChange:s=>x(s.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 dark:bg-zinc-900/50 border border-slate-200 dark:border-zinc-800 rounded-lg outline-none text-[11px] font-bold"})]}),e.jsx("button",{onClick:()=>S(),className:"p-2 text-slate-400 hover:bg-slate-100 dark:hover:bg-zinc-900 rounded-lg transition-colors",children:e.jsx(M,{size:14})})]}),e.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:e.jsxs("table",{className:"w-full text-left border-separate border-spacing-0",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50/90 dark:bg-zinc-950/90 backdrop-blur-sm",children:e.jsxs("tr",{className:"text-slate-400 text-[9px] font-black uppercase tracking-widest",children:[e.jsx("th",{className:"w-12 pl-6 py-4",children:e.jsx("button",{className:"text-indigo-600",onClick:()=>I(m.length===f.length?[]:f.map(s=>s.id)),children:m.length===f.length&&f.length>0?e.jsx(X,{size:16,className:"text-teal-500"}):e.jsx(K,{size:16})})}),e.jsx("th",{className:"px-4 py-4",children:"Identity"}),e.jsx("th",{className:"px-4 py-4",children:"ID Number"}),e.jsx("th",{className:"px-4 py-4",children:"Course"}),e.jsx("th",{className:"px-4 py-4",children:"Status"}),e.jsx("th",{className:"px-4 py-4 text-right pr-6",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-zinc-900",children:f.map(s=>e.jsx(Me,{student:s,isActive:t?.id===s.id,isSelected:m.includes(s.id),onSelect:T,onView:E,courses:r},s.id))})]})})]})]})]})},Oe=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{O as I,Ce as P,Oe as c};
